---
  import CartSidebar from "../components/CartSidebar.astro";
  import { getProductCategories } from "../lib/wp.ts";

const categories = await getProductCategories();
---  
    <header>
        <nav class="shadow-md bg-primary px-4 lg:px-6 py-2.5">
          <div class="flex items-center  flex-wrap lg:flex-nowrap gap-4 mx-auto max-w-screen-xl">
            <!-- Logo a la izquierda -->
            <div class="flex-none">
              <a href="../" class="flex items-center flex-shrink-0">
                <img src="/img/logo.webp" class="h-12" alt="Boveda de cursos 2025" />
              </a>
            </div>
            <div class="grow items-center">
              <!-- ‚úÖ Men√∫ pegado al logo (IZQUIERDA) -->
              <div id="mobile-menu"
                class="hidden fixed inset-0 bg-primary z-50 lg:static lg:flex lg:w-max lg:order-1">
                
                <div class="flex justify-end px-6 p-4 lg:hidden">
                  <button id="menu-close" class="text-black hover:text-black text-3xl font-bold">
                    &times;
                  </button>
                </div>

                <div class="flex flex-col-reverse lg:flex-row w-full">
                    <div class="flex items-center shrink-0">
                      <ul class="flex flex-col w-full font-medium lg:flex-row lg:w-auto">
                        <li><a href="../" class="block w-full py-3 lg:py-1 text-shadow-md text-lg px-6 text-gray-800 rounded hover:bg-black hover:text-white transition-colors duration-200">Inicio</a></li>
                        <li><a href="/Cursos" class="block w-full py-3 lg:py-1  whitespace-nowrap overflow-hidden text-ellipsis text-shadow-md text-lg px-6 text-gray-800 rounded hover:bg-black hover:text-white transition-colors duration-200">Todos nuestros cursos</a></li>
                        <li>
                          <div class="relative lg:inline-block group hidden">
                            <a class="cursor-pointer block w-full py-3 lg:py-1 rounded text-shadow-md text-lg px-6 text-gray-800 hover:bg-black hover:text-white transition-colors duration-200">
                                Categorias
                            </a>
                            <div class="absolute left-0 top-full h-2 w-full"></div>
                            <div class="absolute  mt-2  bg-white z-50 w-[300px] p-5 space-y-2 rounded-sm opacity-0 group-hover:opacity-100 translate-y-3 group-hover:translate-y-0
                            transition-all duration-300  pointer-events-none group-hover:pointer-events-auto">
                            <ul class="space-y-1">
                              {categories.map((cat : any) => (
                                <li>
                                  <a
                                    href={`/Cursos?category=${encodeURIComponent(cat.name)}`}
                                    class="block px-3 py-2 rounded hover:bg-blue-100 transition"
                                  >
                                    {cat.name}
                                  </a>
                                </li>
                              ))}
                            </ul>
                            </div>
                          </div>
                        </li>
                        <li>
                          <li class="lg:hidden">
                            <!-- Bot√≥n acorde√≥n -->
                            <button
                              id="btnCategorias"
                              class="w-full flex justify-between items-center py-3 px-6 text-lg
                                     text-gray-800 hover:bg-primary transition
                                     hover:bg-black hover:text-white"
                            >
                              Categor√≠as
                              <svg
                                id="iconCategorias"
                                class="w-5 h-5 transition-transform duration-300"
                                fill="none"
                                stroke="currentColor"
                                viewBox="0 0 24 24"
                              >
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M19 9l-7 7-7-7"/>
                              </svg>
                            </button>
                          
                            <!-- Contenido acorde√≥n -->
                            <div
                              id="menuCategorias"
                              class="max-h-0 overflow-hidden transition-all duration-300"
                            >
                            <ul>
                              {categories.map((cat : any) => (
                                <li>
                                  <a
                                    href={`/Cursos?category=${encodeURIComponent(cat.name)}`}
                                    class="block px-10 py-2 hover:bg-black hover:text-white"
                                  >
                                    {cat.name}
                                  </a>
                                </li>
                              ))}
                            </ul>
                            </div>
                          </li>              
                        </li> 
                        <li><a href="https://t.me/bovedadecursos/" target="_blank" class="block w-full py-3 lg:py-1 rounded  whitespace-nowrap overflow-hidden text-ellipsis text-shadow-md text-lg px-6 text-gray-800 hover:bg-black hover:text-white transition-colors duration-200">Soporte 24/7</a></li>
                      </ul>
                      
                    </div>
                
                  <!-- ‚úÖ Buscador ocupa todo el espacio restante -->
                  <div class="flex-1 p-5 w-full"> <!-- üîπ Aqu√≠ se agreg√≥ flex-1 -->
                    <form action="/Cursos" method="GET" class="w-full">
                      <label for="default-search" class="sr-only">Buscar</label>
                      <div class="flex gap-2 items-center">
                        <div class="relative flex-grow">
                          <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                            <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="none" viewBox="0 0 20 20">
                              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z" />
                            </svg>
                          </div>
                          <input type="search" name="q" id="default-search"
                            class="block w-full p-3 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                            placeholder="Buscar cursos" required />
                        </div>
                      </div>
                    </form>
                  </div>
                </div>                
              </div>
            </div>
            
            <!-- Botones a la derecha -->
            <div class="flex items-center gap-2 flex-shrink-0 lg:order-2">
              <a href="https://vip.bovedadecursos2025.com/mi-cuenta/"
                class="hover:text-white hover:bg-black focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-lg px-4 py-2 focus:outline-none">Iniciar
                sesi√≥n</a>
                <CartSidebar/>
              <button id="menu-toggle" type="button"
                class="inline-flex items-center p-2 text-sm text-black rounded-lg lg:hidden hover:bg-black hover:text-white">
                <span class="sr-only">Abrir men√∫</span>
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd"
                    d="M3 5h14a1 1 0 010 2H3a1 1 0 010-2zm0 5h14a1 1 0 010 2H3a1 1 0 010-2zm0 5h14a1 1 0 010 2H3a1 1 0 010-2z"
                    clip-rule="evenodd" />
                </svg>
              </button>
            </div>
          </div>
         
        </nav>
      </header>
        
      <script>
        const toggleBtn = document.getElementById('menu-toggle');
        const closeBtn = document.getElementById('menu-close');
        const mobileMenu = document.getElementById('mobile-menu');
      
        toggleBtn!.addEventListener('click', () => {
          // Mostrar y transicionar suavemente
          mobileMenu!.classList.remove('hidden', 'menu-hidden');
          setTimeout(() => {
            mobileMenu!.classList.add('menu-visible');
          }, 10); // peque√±o delay para permitir que la transici√≥n se active
        });
      
        closeBtn!.addEventListener('click', () => {
          mobileMenu!.classList.remove('menu-visible');
          mobileMenu!.classList.add('menu-hidden');
      
          setTimeout(() => {
            mobileMenu!.classList.add('hidden');
          }, 300); // mismo tiempo que la transici√≥n
        });
      
        // Si haces clic en un enlace del men√∫ m√≥vil
        document.querySelectorAll('#mobile-menu a').forEach(link => {
          link.addEventListener('click', () => {
            mobileMenu!.classList.remove('menu-visible');
            mobileMenu!.classList.add('menu-hidden');
            setTimeout(() => mobileMenu!.classList.add('hidden'), 300);
          });
        });
      </script>

<script class="">
  const btn = document.getElementById("btnCategorias");
  const menu = document.getElementById("menuCategorias");
  const icon = document.getElementById("iconCategorias");

  btn.addEventListener("click", () => {
    const abierto = menu.classList.contains("max-h-96");

    menu.classList.toggle("max-h-96");
    icon.classList.toggle("rotate-180");
  });
</script>
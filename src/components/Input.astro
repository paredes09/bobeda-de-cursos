---
import type { HTMLAttributes } from 'astro/types';
import Eye from './icons/Eye.astro'; 

interface Props extends HTMLAttributes<"input"> {
    name: string;
    label: string;
}
const  { label, name,  ...rest }: Props = Astro.props;

const randomID = Math.random();
---

<div class="relative gap-6">
 
  <input
    id={`input-${randomID}`}
    {...rest}
    name={name}
    placeholder=""
    required
    minlength={rest.type === "password" ? "6" : undefined} 
    type={rest.type}
    class="peer mt-1 w-full border-b-2 border-gray-300 px-0 py-1
           placeholder:text-transparent focus:border-gray-500
           focus:outline-none pr-10"  
  />

  <label
    for={`input-${randomID}`}
    class="pointer-events-none absolute top-0 left-0 origin-left 
           -translate-y-1/2 transform text-sm text-gray-800 opacity-75
           transition-all duration-100 ease-in-out
           peer-placeholder-shown:top-1/2 peer-placeholder-shown:text-base
           peer-placeholder-shown:text-gray-500 peer-focus:top-0 peer-focus:pl-0
           peer-focus:text-sm peer-focus:text-gray-800"
  >
    {label}
  </label>

  {rest.type === "password" && (
    <button
      type="button"
      class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-600"
      onclick={`
        const input = document.getElementById('input-${randomID}');
        const svgEye = '<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1.5 12s4.5-7.5 10.5-7.5S22.5 12 22.5 12s-4.5 7.5-10.5 7.5S1.5 12 1.5 12z"/><circle cx="12" cy="12" r="3"/></svg>';
        const svgEyeOff = '<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M20.707 20.707a1 1 0 0 0 0-1.414l-16-16a1 1 0 0 0-1.414 1.414L5.205 6.62C2.785 8.338 1.5 10.683 1.5 12c0 2.25 3.75 7.5 10.5 7.5 1.916 0 3.59-.423 5.006-1.08l2.287 2.287a1 1 0 0 0 1.414 0zm-5.228-3.814-1.774-1.774A4 4 0 0 1 8.38 9.794L6.644 8.058a9.332 9.332 0 0 0-1.09.84C4.28 10.034 3.5 11.417 3.5 12c0 .584.781 1.966 2.052 3.103C7.231 16.605 9.438 17.5 12 17.5c1.25 0 2.417-.213 3.48-.607zm4.841-.815C21.751 14.61 22.5 13.006 22.5 12c0-2.25-3.75-7.5-10.5-7.5-1.043 0-2.015.125-2.912.346l1.721 1.72c.388-.043.785-.066 1.191-.066 2.562 0 4.77.895 6.448 2.397 1.27 1.137 2.052 2.52 2.052 3.103 0 .51-.596 1.63-1.595 2.663l1.415 1.415z" fill="#000000"/></svg>';
        input.type = input.type === 'password' ? 'text' : 'password';
        this.innerHTML = input.type === 'password' ? svgEye : svgEyeOff;
      `}
    >
      <Eye/>
    </button>
  )}
</div>
